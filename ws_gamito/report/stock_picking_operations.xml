<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <template id="report_stockpicking_inherited" inherit_id="stock.report_picking">
        <xpath expr="//t[@t-call='web.external_layout']" position="before">
            <t t-set="total_net_weight" t-value="0"/>
            <t t-set="total_weight" t-value="0"/>
            <t t-foreach="o.move_ids" t-as="move">
                <t t-foreach="move.move_line_ids" t-as="move_line">
                    <t t-set="product_net_weight" t-value="move_line.product_id.product_tmpl_id.net_weight or 0"/>
                    <t t-set="product_weight" t-value="move_line.product_id.product_tmpl_id.weight or 0"/>
                    <t t-set="total_net_weight" t-value="total_net_weight + product_net_weight * move_line.qty_done"/>
                    <t t-set="total_weight" t-value="total_weight + product_weight * move_line.qty_done"/>
                </t>
            </t>
        </xpath>

        <xpath expr="//table[last()]" position="after">
            <div class="row mt-4">
                <div class="col-6">
                    <strong>Total Peso Neto:</strong>
                    <span t-esc="total_net_weight / 1000"/> Kg
                </div>
                <div class="col-6">
                    <strong>Total Peso Bruto:</strong>
                    <span t-esc="total_weight  / 1000"/> Kg
                </div>
            </div>
        </xpath>
		
		<xpath expr="//table[.//t[contains(@t-foreach, 'move_line_ids_without_package')]]//thead/tr" position="inside">
			<th><strong>Net Weight</strong></th>
			<th><strong>Gross Weight</strong></th>
		</xpath>
			<!-- Extender las filas de la tabla específica para añadir los pesos neto y bruto -->
		<xpath expr="//table[.//t[contains(@t-foreach, 'move_line_ids_without_package')]]//tbody/tr" position="inside">
			<td>
				<span t-esc="ml.qty_done * ml.product_id.weight_net"/>
			</td>
			<td>
				<span t-esc="ml.qty_done * ml.product_id.weight"/>
			</td>
		</xpath>
    </template>
</odoo>