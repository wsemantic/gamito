<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <template id="report_delivery_document_inherited" inherit_id="stock.report_delivery_document">
        <xpath expr="//t[@t-call='web.external_layout']" position="before">
            <t t-set="total_net_weight" t-value="0"/>
            <t t-set="total_weight" t-value="0"/>
            <t t-set="total_bulto" t-value="0"/>
            <t t-set="total_palet" t-value="0"/>
            <t t-foreach="o.move_ids" t-as="move_line">                
				<t t-set="product_net_weight" t-value="move_line.product_id.product_tmpl_id.net_weight or 0"/>
				<t t-set="total_net_weight" t-value="total_net_weight + product_net_weight * move_line.product_uom_qty"/>
									
				<t t-set="product_weight" t-value="move_line.product_id.product_tmpl_id.weight or 0"/>
				<t t-set="total_weight" t-value="total_weight + product_weight * move_line.product_uom_qty"/>
				
				<t t-if="move_line.product_id.product_tmpl_id.packaging_ids.qty &gt; 0">
					<t t-set="total_bulto" t-value="total_bulto + move_line.product_uom_qty / move_line.product_id.product_tmpl_id.packaging_ids.qty"/>
				</t>
								
				<t t-if="move_line.product_id.product_tmpl_id.packaging_ids.ws_cajas_por_bulto &gt; 0">
					<t t-set="total_palet" t-value="total_palet + move_line.product_uom_qty / move_line.product_id.product_tmpl_id.packaging_ids.ws_cajas_por_bulto"/>
				</t>
            </t>
        </xpath>
        <xpath expr="//div[hasclass('page')]" position="inside">
            <div class="row mt-4">
                <div class="col-3">
                    <strong>Total Peso Neto:</strong>
                    <span t-esc="total_net_weight / 1000"/> Kg
                </div>
                <div class="col-3">
                    <strong>Total Peso Bruto:</strong>
                    <span t-esc="total_weight  / 1000"/> Kg
                </div>
                <div class="col-3">
                    <strong>Total Bultos:</strong>
                    <span t-esc="Math.ceil(total_bulto)"/>
                </div>
                <div class="col-3">
                    <strong>Total Palets:</strong>
                    <span t-esc="Math.ceil(total_palet"/>
                </div>              
            </div>
        </xpath>
        
        <xpath expr="//table[@name='stock_move_table']/thead/tr" position="inside">
            <th name="th_bultos"><strong>Bultos</strong></th>           
        </xpath>
        <xpath expr="//table[@name='stock_move_table']/tbody/tr" position="inside">
            <td>
                <span t-esc="move.product_uom_qty / move.product_id.product_tmpl_id.packaging_ids.qty"/>
            </td>
        </xpath>
    </template>
</odoo>